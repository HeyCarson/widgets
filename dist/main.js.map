{"mappings":"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","sources":["src/developer/builder.js","src/developer/index.js"],"sourcesContent":["const logoImgLight = 'https://carson-themes.s3.amazonaws.com/assets/heycarson-logo-light.svg'\nconst logoImgDark = 'https://carson-themes.s3.amazonaws.com/assets/heycarson-logo-dark.svg'\nconst starLight = 'https://carson-themes.s3.amazonaws.com/assets/heycarson-star-light.svg'\nconst starDark = 'https://carson-themes.s3.amazonaws.com/assets/heycarson-star-dark.svg'\n\nconst THEMES_PAGE = 'https://heycarson.com/themes'\nconst DEVELOPER_PAGE = 'https://heycarson.com/themes/developer/'\n\nexport const checkSize = (container, width) => {\n  container.classList.toggle('hc-developer-widget--small', width <= 390)\n  container.classList.toggle('hc-developer-widget--left', width <= 300)\n\n  const logoContainer = container.querySelector('.hc-developer-widget__logo-container')\n  logoContainer.classList.toggle('hc-developer-widget__logo-container--small', width <= 390)\n  logoContainer.classList.toggle('hc-developer-widget__logo-container--left', width <= 300)\n\n  const starContainer = container.querySelector('.hc-developer-widget__star-container')\n  starContainer.classList.toggle('hc-developer-widget__star-container--small', width <= 300)\n  starContainer.classList.toggle('hc-developer-widget__star-container--left', width <= 300)\n\n  const reviewContainer = container.querySelector('.hc-developer-widget__review-container')\n  reviewContainer.classList.toggle('hc-developer-widget__review-container--small', width <= 300)\n  reviewContainer.classList.toggle('hc-developer-widget__review-container--left', width <= 300)\n}\n\nexport const changeWidget = (container, { dark, rating, reviews, developer } = {}) => {\n  container.classList.toggle('hc-developer-widget--dark', dark)\n\n  container.replaceChild(\n    buildLogo({ dark }),\n    container.querySelector('.hc-developer-widget__logo-container')\n  )\n\n  container.replaceChild(\n    buildStar({ rating, dark }),\n    container.querySelector('.hc-developer-widget__star-container')\n  )\n\n  container.replaceChild(\n    buildReviews({\n      developer, rating, reviews, dark\n    }),\n    container.querySelector('.hc-developer-widget__review-container')\n  )\n\n}\n\nconst buildLogo = ({ dark }) => {\n  const logoContainer = document.createElement('a')\n  const logo = document.createElement('img')\n\n  logoContainer.setAttribute('href', THEMES_PAGE + '?wgl=1')\n  logoContainer.setAttribute('target', '_blank')\n  logoContainer.setAttribute('rel', 'noopener')\n  logoContainer.classList.add('hc-developer-widget__logo-container')\n  logo.classList.add('hc-developer-widget__logo')\n  logo.setAttribute('src', !dark ? logoImgDark : logoImgLight)\n\n  logoContainer.appendChild(logo)\n\n  return logoContainer\n}\n\nconst buildStar = ({ rating, dark }) => {\n  const starAmount = Math.floor(rating)\n  const starContainer = document.createElement('div')\n  const star = document.createElement('img')\n  const starBack = document.createElement('div')\n\n  star.classList.add('hc-developer-widget__star')\n  star.setAttribute('src', dark ? starDark : starLight)\n  starBack.classList.add('hc-developer-widget__star-background')\n  starBack.classList.toggle('hc-developer-widget__star-background--dark', dark)\n\n  starContainer.classList.add('hc-developer-widget__star-container')\n\n  starBack.appendChild(star)\n\n  ;(new Array(starAmount).fill(0))\n    .forEach(star => starContainer.appendChild(starBack.cloneNode(true)))\n\n  return starContainer\n}\n\nconst buildReviews = ({ developer, rating, reviews, dark }) => {\n  const reviewContainer = document.createElement('div')\n  const rate = document.createElement('span')\n  const separator = document.createElement('span')\n  const review = document.createElement('a')\n\n  reviewContainer.classList.add('hc-developer-widget__review-container')\n\n  rate.classList.add('hc-developer-widget__rating')\n  rate.classList.toggle('hc-developer-widget__rating--dark', dark)\n  separator.classList.add('hc-developer-widget__separator')\n  separator.classList.toggle('hc-developer-widget__separator--dark', dark)\n  review.classList.add('hc-developer-widget__review')\n  review.classList.toggle('hc-developer-widget__review--dark', dark)\n\n  rate.innerText = rating\n  separator.innerText = '|'\n\n  review.innerText = reviews === 1 ? '1 review' : `${reviews} reviews`\n  review.setAttribute('href', DEVELOPER_PAGE + developer + '?wgl=1')\n  review.setAttribute('target', '_blank')\n  review.setAttribute('rel', 'noopener')\n\n  reviewContainer.appendChild(rate)\n  reviewContainer.appendChild(separator)\n  reviewContainer.appendChild(review)\n\n  return reviewContainer\n}\n\nexport default function builder (element, options = {}) {\n  const container = document.createElement('div')\n\n  container.classList.add('hc-developer-widget')\n  container.classList.toggle('hc-developer-widget--dark', options.dark)\n\n  container.appendChild(buildLogo({ dark: options.dark }))\n  container.appendChild(buildStar({\n    rating: options.rating,\n    dark: options.dark\n  }))\n  container.appendChild(buildReviews({\n    rating: options.rating,\n    developer: options.developer,\n    reviews: options.reviews,\n    dark: options.dark\n  }))\n\n  element.appendChild(container)\n\n  return container\n}\n","import builder, { changeWidget, checkSize } from './builder.js'\n\nconst initialOptions = {\n  endpoint: 'https://referral-api.heycarson.com',\n  element: null,\n  apiKey: null,\n  developer: '',\n  light: true,\n\n  debug: false,\n  fetchDeveloper: null\n}\n\nconst fetchDeveloper = async (endpoint, apiKey) => {\n  return await fetch(`${endpoint}/v1/theme-developer-widget?hc_api_key=${encodeURIComponent(apiKey)}`)\n    .then((res) => {\n      if (res.ok) {\n        return res.json()\n      }\n\n      if (res.status === 404) {\n        return null\n      }\n\n      const body = res.json()\n\n      throw new Error('Something went wrong' + (body?.message ? `: ${body.message}` : ''))\n    })\n}\n\nclass DeveloperWidget {\n  constructor (options = {}) {\n    this.options = { ...initialOptions, ...options }\n\n    this.developer = null\n    this.apiKey = null\n\n    this.container = null\n    this.observerTimeout = null\n\n    this.observer = new ResizeObserver(entries => {\n      clearTimeout(this.observerTimeout)\n\n      if (!entries.length) {\n        return\n      }\n\n      const { width } = entries[0].contentRect\n\n      this.observerTimeout = setTimeout(() => {\n        checkSize(this.container, width)\n      }, 100)\n    })\n  }\n\n  async render (options = {}) {\n    if (!(this.options.element instanceof Element)) {\n      throw new Error('options.element: HTMLElement is required')\n    }\n\n    this.options = { ...initialOptions, ...this.options, ...options, element: this.options.element }\n\n    if (this.apiKey !== this.options.apiKey) {\n      if (this.options.fetchDeveloper instanceof Function) {\n        this.developer = await this.options.fetchDeveloper(this.options)\n      } else {\n        this.developer = await fetchDeveloper(this.options.endpoint, this.options.apiKey, !this.developer)\n      }\n    }\n\n    if (!this.developer) {\n      throw new Error('Developer not found')\n    }\n\n    let rating = Number(this.developer.review_rating || this.developer.overall_rating || 0)\n    rating = rating.toFixed(1) // Math.floor(rating) === rating ? 0 : 1\n\n    this.observer.disconnect()\n\n    if (!this.container) {\n      this.container = builder(this.options.element, {\n        rating,\n        developer: this.developer.slug,\n        dark: !this.options.light,\n        reviews: this.developer.review_count\n      })\n    } else {\n      changeWidget(this.container, {\n        rating,\n        developer: this.developer.slug,\n        dark: !this.options.light,\n        reviews: this.developer.review_count\n      })\n    }\n\n    this.observer.observe(this.options.element)\n  }\n\n  destroy () {\n    if (!this.options.element || !this.options.element.childNodes.length) {\n      return\n    }\n\n    this.observer.disconnect()\n    this.options.element.removeChild(this.container)\n    this.container = null\n  }\n}\n\nexport default DeveloperWidget\n"],"names":["$24929a3f1f5cf200$export$c4a38de546513c4e","container","width","classList","toggle","logoContainer","querySelector","starContainer","reviewContainer","$24929a3f1f5cf200$export$1d83028bd73dd3cc","dark","rating","reviews","developer","replaceChild","$24929a3f1f5cf200$var$buildLogo","$24929a3f1f5cf200$var$buildStar","$24929a3f1f5cf200$var$buildReviews","document","createElement","logo","setAttribute","$24929a3f1f5cf200$var$THEMES_PAGE","add","appendChild","starAmount","Math","floor","star","starBack","Array","fill","forEach","cloneNode","rate","separator","review","innerText","$24929a3f1f5cf200$export$2e2bcd8739ae039","element","options","$1d2144e4716db95f$var$initialOptions","endpoint","apiKey","light","debug","fetchDeveloper","$1d2144e4716db95f$export$2e2bcd8739ae039","constructor","this","observerTimeout","observer","ResizeObserver","entries","clearTimeout","length","contentRect","setTimeout","async","Element","Error","Function","fetch","encodeURIComponent","then","res","ok","json","status","body","message","$1d2144e4716db95f$var$fetchDeveloper","Number","review_rating","overall_rating","toFixed","disconnect","slug","review_count","observe","destroy","childNodes","removeChild"],"version":3,"file":"main.js.map"}