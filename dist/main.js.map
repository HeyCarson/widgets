{"mappings":"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","sources":["src/index.js","src/developer/index.js","src/developer/builder.js"],"sourcesContent":["export { default as DeveloperWidget } from './developer/index.js'\n","import builder, { changeWidget, checkSize } from './builder.js'\n\nconst initialOptions = {\n  endpoint: 'https://api.heycarson.com',\n  element: null,\n  apiKey: null,\n  developer: '',\n  darkMode: false\n}\n\nconst fetchDeveloper = async (endpoint, dev, wgp) => {\n  return await fetch(`${endpoint}/v1/themes/developers/${dev}${wgp ? '?wgp=1' : ''}`)\n    .then((res) => {\n      if (res.ok) {\n        return res.json()\n      }\n\n      if (res.status === 404) {\n        return null\n      }\n\n      const body = res.json()\n\n      throw new Error('Something went wrong' + (body?.message ? `: ${body.message}` : ''))\n    })\n}\n\nclass DeveloperWidget {\n  constructor (options = {}) {\n    this.options = { ...initialOptions, ...options }\n\n    this.developer = null\n\n    this.container = null\n    this.viewportHandler = null\n    this.observerTimeout = null\n\n    this.observer = new ResizeObserver(entries => {\n      clearTimeout(this.observerTimeout)\n\n      if (!entries.length) {\n        return\n      }\n\n      const { width } = entries[0].contentRect\n\n      this.observerTimeout = setTimeout(() => {\n        checkSize(this.container, width)\n      }, 100)\n    })\n  }\n\n  async render (options = {}) {\n    if (!(this.options.element instanceof Element)) {\n      throw new Error('options.element: HTMLElement is required')\n    }\n\n    this.options = { ...initialOptions, ...this.options, ...options, element: this.options.element }\n\n    if (this.developer?.slug !== this.options.developer) {\n      this.developer = await fetchDeveloper(this.options.endpoint, this.options.developer, !this.developer)\n    }\n\n    if (!this.developer) {\n      throw new Error('Developer not found')\n    }\n\n    let rating = Number(this.developer.review_rating || this.developer.overall_rating || 0)\n    rating = rating.toFixed(Math.floor(rating) === rating ? 0 : 1)\n\n    if (!this.container) {\n      this.container = builder(this.options.element, {\n        rating,\n        developer: this.developer.slug,\n        dark: this.options.darkMode,\n        reviews: this.developer.review_count\n      })\n\n      this.observer.observe(this.container)\n    } else {\n      changeWidget(this.container, {\n        rating,\n        developer: this.developer.slug,\n        dark: this.options.darkMode,\n        reviews: this.developer.review_count\n      })\n    }\n  }\n\n  destroy () {\n    if (!this.options.element || !this.options.element.childNodes.length) {\n      return\n    }\n\n    this.observer.disconnect()\n\n    this.container.removeEventListener('resize', this.viewportHandler)\n\n    this.options.element.removeChild(this.container)\n  }\n}\n\nexport default DeveloperWidget\n","const logoImgLight = 'https://carson-themes.s3.amazonaws.com/assets/heycarson-logo-light.svg'\nconst logoImgDark = 'https://carson-themes.s3.amazonaws.com/assets/heycarson-logo-dark.svg'\nconst starImg = 'https://carson-themes.s3.amazonaws.com/assets/heycarson-star.svg'\n\nconst THEMES_PAGE = 'https://heycarson.com/themes'\nconst DEVELOPER_PAGE = 'https://heycarson.com/themes/developer/'\nconst smallBreakpoint = 410\nconst containerPadding = 32\n\nexport const checkSize = (container, width) => {\n  const isSmall = width <= smallBreakpoint - containerPadding\n\n  container\n    .classList.toggle('hc-developer-widget--small', isSmall)\n  container\n    .querySelector('.hc-developer-widget__logo-container')\n    .classList.toggle('hc-developer-widget__logo-container--small', isSmall)\n  container\n    .querySelector('.hc-developer-widget__star-container')\n    .classList.toggle('hc-developer-widget__star-container--small', isSmall)\n  container\n    .querySelector('.hc-developer-widget__review-container')\n    .classList.toggle('hc-developer-widget__review-container--small', isSmall)\n}\n\nexport const changeWidget = (container, { dark, rating, reviews, developer } = {}) => {\n  container\n    .classList.toggle('hc-developer-widget--dark', dark)\n  container\n    .querySelector('.hc-developer-widget__logo')\n    .setAttribute('src', dark ? logoImgDark : logoImgLight)\n  container\n    .querySelector('.hc-developer-widget__based')\n    .classList.toggle('hc-developer-widget__based--dark', dark)\n\n  const ratingEl = container.querySelector('.hc-developer-widget__rating')\n  ratingEl.innerText = `${rating} / 5`\n  ratingEl.classList.toggle('hc-developer-widget__rating--dark', dark)\n\n  const reviewEl = container.querySelector('.hc-developer-widget__review')\n  reviewEl.innerText = reviews === 1 ? '1 review' : `${reviews} reviews`\n  reviewEl.setAttribute('href', `${DEVELOPER_PAGE}${developer}`)\n  reviewEl.classList.toggle('hc-developer-widget__review--dark', dark)\n}\n\nconst buildLogo = ({ dark }) => {\n  const logoContainer = document.createElement('a')\n  const logo = document.createElement('img')\n\n  logoContainer.setAttribute('href', THEMES_PAGE + '?wgl=1')\n  logoContainer.setAttribute('target', '_blank')\n  logoContainer.setAttribute('rel', 'noopener')\n  logoContainer.classList.add('hc-developer-widget__logo-container')\n  logo.classList.add('hc-developer-widget__logo')\n  logo.setAttribute('src', dark ? logoImgDark : logoImgLight)\n\n  logoContainer.appendChild(logo)\n\n  return logoContainer\n}\n\nconst buildStar = ({ rating, dark }) => {\n  const starContainer = document.createElement('div')\n  const star = document.createElement('img')\n  const rate = document.createElement('span')\n\n  starContainer.classList.add('hc-developer-widget__star-container')\n  star.classList.add('hc-developer-widget__star')\n  rate.classList.add('hc-developer-widget__rating')\n  rate.classList.toggle('hc-developer-widget__rating--dark', dark)\n\n  star.setAttribute('src', starImg)\n  rate.innerText = `${rating} / 5`\n\n  starContainer.appendChild(star)\n  starContainer.appendChild(rate)\n\n  return starContainer\n}\n\nconst buildReviews = ({ developer, reviews, dark }) => {\n  const reviewContainer = document.createElement('div')\n  const based = document.createElement('span')\n  const review = document.createElement('a')\n\n  reviewContainer.classList.add('hc-developer-widget__review-container')\n\n  based.classList.add('hc-developer-widget__based')\n  based.classList.toggle('hc-developer-widget__based--dark', dark)\n  review.classList.add('hc-developer-widget__review')\n  review.classList.toggle('hc-developer-widget__review--dark', dark)\n\n  based.innerText = 'Based on'\n\n  review.innerText = `${reviews} reviews`\n  review.setAttribute('href', DEVELOPER_PAGE + developer + '?wgl=1')\n  review.setAttribute('target', '_blank')\n  review.setAttribute('rel', 'noopener')\n\n  reviewContainer.appendChild(based)\n  reviewContainer.appendChild(review)\n\n  return reviewContainer\n}\n\nexport default function builder (element, options = {}) {\n  const container = document.createElement('div')\n\n  container.classList.add('hc-developer-widget')\n  container.classList.toggle('hc-developer-widget--dark', options.dark)\n\n  container.appendChild(buildLogo({ dark: options.dark }))\n  container.appendChild(buildStar({\n    rating: options.rating,\n    dark: options.dark\n  }))\n  container.appendChild(buildReviews({\n    developer: options.developer,\n    reviews: options.reviews,\n    dark: options.dark\n  }))\n\n  element.appendChild(container)\n\n  return container\n}\n"],"names":[],"version":3,"file":"main.js.map"}