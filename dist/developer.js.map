{"mappings":"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","sources":["src/developer/index.js","src/developer/builder.js"],"sourcesContent":["import builder, { changeWidget, checkSize } from './builder.js'\n\nconst initialOptions = {\n  endpoint: 'https://api.heycarson.com',\n  element: null,\n  apiKey: null,\n  developer: '',\n  light: true\n}\n\nconst fetchDeveloper = async (endpoint, dev, wgp) => {\n  return await fetch(`${endpoint}/v1/themes/developers/${dev}${wgp ? '?wgp=1&slug=1' : ''}`)\n    .then((res) => {\n      if (res.ok) {\n        return res.json()\n      }\n\n      if (res.status === 404) {\n        return null\n      }\n\n      const body = res.json()\n\n      throw new Error('Something went wrong' + (body?.message ? `: ${body.message}` : ''))\n    })\n}\n\nclass DeveloperWidget {\n  constructor (options = {}) {\n    this.options = { ...initialOptions, ...options }\n\n    this.developer = null\n\n    this.container = null\n    this.observerTimeout = null\n\n    this.observer = new ResizeObserver(entries => {\n      clearTimeout(this.observerTimeout)\n\n      if (!entries.length) {\n        return\n      }\n\n      const { width } = entries[0].contentRect\n\n      this.observerTimeout = setTimeout(() => {\n        checkSize(this.container, width)\n      }, 100)\n    })\n  }\n\n  async render (options = {}) {\n    if (!(this.options.element instanceof Element)) {\n      throw new Error('options.element: HTMLElement is required')\n    }\n\n    this.options = { ...initialOptions, ...this.options, ...options, element: this.options.element }\n\n    if (this.developer?.slug !== this.options.developer) {\n      this.developer = await fetchDeveloper(this.options.endpoint, this.options.developer, !this.developer)\n    }\n\n    if (!this.developer) {\n      throw new Error('Developer not found')\n    }\n\n    let rating = Number(this.developer.review_rating || this.developer.overall_rating || 0)\n    rating = rating.toFixed(1) // Math.floor(rating) === rating ? 0 : 1\n\n    this.observer.disconnect()\n\n    if (!this.container) {\n      this.container = builder(this.options.element, {\n        rating,\n        developer: this.developer.slug,\n        dark: !this.options.light,\n        reviews: this.developer.review_count\n      })\n    } else {\n      changeWidget(this.container, {\n        rating,\n        developer: this.developer.slug,\n        dark: !this.options.light,\n        reviews: this.developer.review_count\n      })\n    }\n\n    this.observer.observe(this.options.element)\n  }\n\n  destroy () {\n    if (!this.options.element || !this.options.element.childNodes.length) {\n      return\n    }\n\n    this.observer.disconnect()\n    this.options.element.removeChild(this.container)\n    this.container = null\n  }\n}\n\nexport default DeveloperWidget\n","const logoImgLight = 'https://carson-themes.s3.amazonaws.com/assets/heycarson-logo-light.svg'\nconst logoImgDark = 'https://carson-themes.s3.amazonaws.com/assets/heycarson-logo-dark.svg'\nconst starLight = 'https://carson-themes.s3.amazonaws.com/assets/heycarson-star-light.svg'\nconst starDark = 'https://carson-themes.s3.amazonaws.com/assets/heycarson-star-dark.svg'\n\nconst THEMES_PAGE = 'https://heycarson.com/themes'\nconst DEVELOPER_PAGE = 'https://heycarson.com/themes/developer/'\n\nexport const checkSize = (container, width) => {\n  container.classList.toggle('hc-developer-widget--small', width <= 390)\n  container.classList.toggle('hc-developer-widget--left', width <= 300)\n\n  const logoContainer = container.querySelector('.hc-developer-widget__logo-container')\n  logoContainer.classList.toggle('hc-developer-widget__logo-container--small', width <= 390)\n  logoContainer.classList.toggle('hc-developer-widget__logo-container--left', width <= 300)\n\n  const starContainer = container.querySelector('.hc-developer-widget__star-container')\n  starContainer.classList.toggle('hc-developer-widget__star-container--small', width <= 300)\n  starContainer.classList.toggle('hc-developer-widget__star-container--left', width <= 300)\n\n  const reviewContainer = container.querySelector('.hc-developer-widget__review-container')\n  reviewContainer.classList.toggle('hc-developer-widget__review-container--small', width <= 300)\n  reviewContainer.classList.toggle('hc-developer-widget__review-container--left', width <= 300)\n}\n\nexport const changeWidget = (container, { dark, rating, reviews, developer } = {}) => {\n  container.classList.toggle('hc-developer-widget--dark', dark)\n\n  container.replaceChild(\n    buildLogo({ dark }),\n    container.querySelector('.hc-developer-widget__logo-container')\n  )\n\n  container.replaceChild(\n    buildStar({ rating, dark }),\n    container.querySelector('.hc-developer-widget__star-container')\n  )\n\n  container.replaceChild(\n    buildReviews({\n      developer, rating, reviews, dark\n    }),\n    container.querySelector('.hc-developer-widget__review-container')\n  )\n\n}\n\nconst buildLogo = ({ dark }) => {\n  const logoContainer = document.createElement('a')\n  const logo = document.createElement('img')\n\n  logoContainer.setAttribute('href', THEMES_PAGE + '?wgl=1')\n  logoContainer.setAttribute('target', '_blank')\n  logoContainer.setAttribute('rel', 'noopener')\n  logoContainer.classList.add('hc-developer-widget__logo-container')\n  logo.classList.add('hc-developer-widget__logo')\n  logo.setAttribute('src', !dark ? logoImgDark : logoImgLight)\n\n  logoContainer.appendChild(logo)\n\n  return logoContainer\n}\n\nconst buildStar = ({ rating, dark }) => {\n  const starAmount = Math.floor(rating)\n  const starContainer = document.createElement('div')\n  const star = document.createElement('img')\n  const starBack = document.createElement('div')\n\n  star.classList.add('hc-developer-widget__star')\n  star.setAttribute('src', dark ? starDark : starLight)\n  starBack.classList.add('hc-developer-widget__star-background')\n  starBack.classList.toggle('hc-developer-widget__star-background--dark', dark)\n\n  starContainer.classList.add('hc-developer-widget__star-container')\n\n  starBack.appendChild(star)\n\n  ;(new Array(starAmount).fill(0))\n    .forEach(star => starContainer.appendChild(starBack.cloneNode(true)))\n\n  return starContainer\n}\n\nconst buildReviews = ({ developer, rating, reviews, dark }) => {\n  const reviewContainer = document.createElement('div')\n  const rate = document.createElement('span')\n  const separator = document.createElement('span')\n  const review = document.createElement('a')\n\n  reviewContainer.classList.add('hc-developer-widget__review-container')\n\n  rate.classList.add('hc-developer-widget__rating')\n  rate.classList.toggle('hc-developer-widget__rating--dark', dark)\n  separator.classList.add('hc-developer-widget__separator')\n  separator.classList.toggle('hc-developer-widget__separator--dark', dark)\n  review.classList.add('hc-developer-widget__review')\n  review.classList.toggle('hc-developer-widget__review--dark', dark)\n\n  rate.innerText = rating\n  separator.innerText = '|'\n\n  review.innerText = reviews === 1 ? '1 review' : `${reviews} reviews`\n  review.setAttribute('href', DEVELOPER_PAGE + developer + '?wgl=1')\n  review.setAttribute('target', '_blank')\n  review.setAttribute('rel', 'noopener')\n\n  reviewContainer.appendChild(rate)\n  reviewContainer.appendChild(separator)\n  reviewContainer.appendChild(review)\n\n  return reviewContainer\n}\n\nexport default function builder (element, options = {}) {\n  const container = document.createElement('div')\n\n  container.classList.add('hc-developer-widget')\n  container.classList.toggle('hc-developer-widget--dark', options.dark)\n\n  container.appendChild(buildLogo({ dark: options.dark }))\n  container.appendChild(buildStar({\n    rating: options.rating,\n    dark: options.dark\n  }))\n  container.appendChild(buildReviews({\n    rating: options.rating,\n    developer: options.developer,\n    reviews: options.reviews,\n    dark: options.dark\n  }))\n\n  element.appendChild(container)\n\n  return container\n}\n"],"names":[],"version":3,"file":"developer.js.map"}